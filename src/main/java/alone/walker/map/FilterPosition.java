package alone.walker.map;

import alone.walker.map.baidu.Points;
import com.alibaba.fastjson.JSON;
import lombok.extern.slf4j.Slf4j;

import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;
import java.util.TreeSet;
import java.util.stream.Collectors;

/**
 * @Author: huangYong
 * @Date: 2020/8/31 14:36
 */
@Slf4j
public class FilterPosition {
    private List<Points> mListPoint = new ArrayList<>();
    final int WALK_MAX_SPEED = 3; //10km/h
    private Boolean isFirst = true;         // 是否是第一次定位点
    private Points weight1 = new Points();        // 权重点1
    private Points weight2;                          // 权重点2
    private List<Points> w1TempList = new ArrayList<>();     // w1的临时定位点集合
    private List<Points> w2TempList = new ArrayList<>();     // w2的临时定位点集合
    private int w1Count = 0; // 统计w1Count所统计过的点数
    private int gtCount = 0; // 统计异常点数


    public Boolean filterPos(Points aMapLocation) {
        String filterString = "";
        try {
            // 获取的第一个定位点不进行过滤
            if (isFirst) {
                isFirst = false;
                weight1.setLatitude(aMapLocation.getLatitude());
                weight1.setLongitude(aMapLocation.getLongitude());
                weight1.setLoc_time(aMapLocation.getLoc_time());

                /****************存储数据到文件中，后面好分析******************/

                filterString += "第一次" + " : ";

                /**********************************/

                // 将得到的第一个点存储入w1的缓存集合
                final Points Points = new Points();
                Points.setLatitude(aMapLocation.getLatitude());
                Points.setLongitude(aMapLocation.getLongitude());
                Points.setLoc_time(aMapLocation.getLoc_time());
                w1TempList.add(Points);
                w1Count++;

                return true;

            } else {
                filterString += "非第一次" + " : ";

                if (weight2 == null) {
                    filterString += "weight2=null" + " : ";
                    // 计算w1与当前定位点p1的时间差并得到最大偏移距离D
                    long offsetTimeMils = aMapLocation.getLoc_time() - weight1.getLoc_time();
                    long MaxDistance = offsetTimeMils * WALK_MAX_SPEED;
                    double distance = LocationUtils.latAndLonDistance(weight1.getLongitude(), weight1.getLatitude(), aMapLocation.getLongitude(), aMapLocation.getLatitude());

                    filterString += "distance = " + distance + ",MaxDistance = " + MaxDistance + " : ";

                    if (distance > MaxDistance) {
                        gtCount++;
                        filterString += "distance > MaxDistance" + "当前点 距离大: 设置w2位新的点，并添加到w2TempList";
                        // 将设置w2位新的点，并存储入w2临时缓存
                        weight2 = new Points();
                        weight2.setLatitude(aMapLocation.getLatitude());
                        weight2.setLongitude(aMapLocation.getLongitude());
                        weight2.setLoc_time(aMapLocation.getLoc_time());
                        return false;
                    } else {
                        filterString += "distance < MaxDistance" + "当前点 距离小 : 添加到w1TempList";
                        // 将p1加入到做坐标集合w1TempList
                        Points Points = new Points();
                        Points.setLatitude(aMapLocation.getLatitude());
                        Points.setLongitude(aMapLocation.getLongitude());
                        Points.setLoc_time(aMapLocation.getLoc_time());
                        w1TempList.add(Points);
                        w1Count++;
                        // 更新w1权值点
                        weight1.setLatitude(weight1.getLatitude() * 0.2 + aMapLocation.getLatitude() * 0.8);
                        weight1.setLongitude(weight1.getLongitude() * 0.2 + aMapLocation.getLongitude() * 0.8);
                        weight1.setLoc_time(aMapLocation.getLoc_time());

                        if (w1Count > 3) {
                            filterString += " : 更新";
                            mListPoint.addAll(w1TempList);
                            w1TempList.clear();
                            return true;
                        } else {
                            filterString += " w1Count<3: 不更新";
                            return false;
                        }
                    }

                } else {
                    filterString += "weight2 != null" + " : ";
                    // 计算w2与当前定位点p1的时间差并得到最大偏移距离D
//                    long offsetTimeMils = aMapLocation.getTime() - weight2.getTime();
                    long offsetTimeMils = 7000;
                    long offsetTimes = (offsetTimeMils / 1000);
                    long MaxDistance = offsetTimes * WALK_MAX_SPEED;
                    double distance = LocationUtils.googleDistance(weight2.getLongitude(), weight2.getLatitude(), aMapLocation.getLongitude(), aMapLocation.getLatitude());
                    filterString += "distance = " + distance + ",MaxDistance = " + MaxDistance + " : ";
                    if (distance > MaxDistance) {
                        gtCount++;
                        filterString += "当前点 距离大: weight2 更新";
                        w2TempList.clear();
                        // 将设置w2位新的点，并存储入w2临时缓存
                        weight2 = new Points();
                        weight2.setLatitude(aMapLocation.getLatitude());
                        weight2.setLongitude(aMapLocation.getLongitude());
                        weight2.setLoc_time(aMapLocation.getLoc_time());
                        return false;
                    } else {
                        filterString += "当前点 距离小: 添加到w2TempList";
                        // 将p1加入到做坐标集合w2TempList
                        Points Points = new Points();
                        Points.setLatitude(aMapLocation.getLatitude());
                        Points.setLongitude(aMapLocation.getLongitude());
                        Points.setLoc_time(aMapLocation.getLoc_time());
                        w2TempList.add(Points);

                        // 更新w2权值点
                        weight2.setLatitude(weight2.getLatitude() * 0.2 + aMapLocation.getLatitude() * 0.8);
                        weight2.setLongitude(weight2.getLongitude() * 0.2 + aMapLocation.getLongitude() * 0.8);
                        weight2.setLoc_time(aMapLocation.getLoc_time());

                        if (w2TempList.size() > 4) {
                            // 判断w1所代表的定位点数是否>4,小于说明w1之前的点为从一开始就有偏移的点
                            if (w1Count > 4) {
                                filterString += "w1Count > 4" + "计算增加W1";
                                mListPoint.addAll(w1TempList);
                            } else {
                                filterString += "w1Count < 4" + "计算丢弃W1";
                                w1TempList.clear();
                            }
                            filterString += "w2TempList.size() > 4" + " : 更新到偏移点";

                            // 将w2TempList集合中数据放入finalList中
                            mListPoint.addAll(w2TempList);

                            // 1、清空w2TempList集合 2、更新w1的权值点为w2的值 3、将w2置为null
                            w2TempList.clear();
                            weight1 = weight2;
                            weight2 = null;
                            return true;

                        } else {
                            filterString += "w2TempList.size() < 4" + "\r\n";
                            return false;
                        }
                    }
                }
            }
        } finally {
            log.info("wsh", filterString);
        }
    }

    public List<Points> Pointss(List<Points> pointsList) {
        ArrayList<Points> arrayList = pointsList.stream().collect(Collectors.collectingAndThen(Collectors.toCollection(() -> new TreeSet<>(Comparator.comparing(points -> points.getLatitude() + ";" + points.getLongitude()))), ArrayList::new));
        pointsList.forEach(this::filterPos);
        return mListPoint;
    }


    public static void main(String[] args) {
        Object[][] objects =  {
                {
                        120.667324,
                        31.144151,
                        0.0,
                        0,
                        1598509823
                },
                {
                        120.667633,
                        31.144084,
                        0.0,
                        0,
                        1598509828
                },
                {
                        120.667824,
                        31.144372,
                        0.0,
                        0,
                        1598509833
                },
                {
                        120.668106,
                        31.144352,
                        0.0,
                        0,
                        1598509943
                },
                {
                        120.668034,
                        31.144437,
                        0.0,
                        0,
                        1598509948
                },
                {
                        120.668049,
                        31.144390,
                        0.0,
                        0,
                        1598509953
                },
                {
                        120.668089,
                        31.144370,
                        0.0,
                        0,
                        1598509958
                },
                {
                        120.668114,
                        31.144331,
                        0.0,
                        0,
                        1598509963
                },
                {
                        120.668144,
                        31.144359,
                        0.0,
                        0,
                        1598509968
                },
                {
                        120.668151,
                        31.144359,
                        0.0,
                        0,
                        1598509973
                },
                {
                        120.668165,
                        31.144381,
                        0.0,
                        0,
                        1598509978
                },
                {
                        120.668134,
                        31.144346,
                        0.0,
                        0,
                        1598513
                },
                {
                        120.668131,
                        31.144339,
                        0.0,
                        0,
                        1598518
                },
                {
                        120.668124,
                        31.144354,
                        0.0,
                        0,
                        1598510013
                },
                {
                        120.668124,
                        31.144336,
                        0.0,
                        0,
                        1598510018
                },
                {
                        120.668149,
                        31.144327,
                        0.0,
                        0,
                        1598510023
                },
                {
                        120.668175,
                        31.144327,
                        0.0,
                        0,
                        1598510028
                },
                {
                        120.668191,
                        31.144311,
                        0.0,
                        0,
                        1598510033
                },
                {
                        120.668200,
                        31.144329,
                        0.0,
                        0,
                        1598510038
                },
                {
                        120.668200,
                        31.144349,
                        0.0,
                        0,
                        1598510063
                },
                {
                        120.668161,
                        31.144399,
                        0.0,
                        0,
                        1598510068
                },
                {
                        120.668139,
                        31.144429,
                        0.0,
                        0,
                        1598510073
                },
                {
                        120.668139,
                        31.144429,
                        0.0,
                        0,
                        1598510078
                },
                {
                        120.668153,
                        31.144441,
                        0.0,
                        0,
                        1598510083
                },
                {
                        120.668158,
                        31.144457,
                        0.0,
                        0,
                        1598510088
                },
                {
                        120.668165,
                        31.144459,
                        0.0,
                        0,
                        1598510093
                },
                {
                        120.668170,
                        31.144446,
                        0.0,
                        0,
                        1598510098
                },
                {
                        120.668228,
                        31.144444,
                        0.0,
                        0,
                        1598510123
                },
                {
                        120.668246,
                        31.144446,
                        0.0,
                        0,
                        1598510128
                },
                {
                        120.668225,
                        31.144431,
                        0.0,
                        0,
                        1598510133
                },
                {
                        120.668213,
                        31.144409,
                        0.0,
                        0,
                        1598510138
                },
                {
                        120.668203,
                        31.144419,
                        0.0,
                        0,
                        1598510143
                },
                {
                        120.668153,
                        31.144452,
                        0.0,
                        0,
                        1598510148
                },
                {
                        120.668111,
                        31.144449,
                        0.0,
                        0,
                        1598510153
                },
                {
                        120.668044,
                        31.144460,
                        0.0,
                        0,
                        1598510158
                },
                {
                        120.667889,
                        31.144470,
                        0.0,
                        0,
                        1598510183
                },
                {
                        120.667832,
                        31.144475,
                        0.0,
                        0,
                        1598510188
                },
                {
                        120.667797,
                        31.144492,
                        0.0,
                        0,
                        1598510193
                },
                {
                        120.667705,
                        31.144451,
                        0.0,
                        0,
                        1598510198
                },
                {
                        120.667669,
                        31.144388,
                        0.0,
                        0,
                        1598510203
                },
                {
                        120.667712,
                        31.144361,
                        0.0,
                        0,
                        1598510208
                },
                {
                        120.667685,
                        31.144323,
                        0.0,
                        0,
                        1598510213
                },
                {
                        120.667662,
                        31.144236,
                        0.0,
                        0,
                        1598510218
                },
                {
                        120.667648,
                        31.144143,
                        0.0,
                        0,
                        1598510243
                },
                {
                        120.667613,
                        31.144139,
                        0.0,
                        0,
                        1598510248
                },
                {
                        120.667638,
                        31.144041,
                        0.0,
                        0,
                        1598510253
                },
                {
                        120.667545,
                        31.143941,
                        0.0,
                        0,
                        1598510258
                },
                {
                        120.667226,
                        31.143595,
                        0.0,
                        0,
                        1598510263
                },
                {
                        120.667630,
                        31.142244,
                        0.0,
                        0,
                        1598510268
                },
                {
                        120.667635,
                        31.141867,
                        0.0,
                        0,
                        1598510273
                },
                {
                        120.667603,
                        31.141737,
                        0.0,
                        0,
                        1598510278
                },
                {
                        120.667770,
                        31.142902,
                        0.0,
                        0,
                        1598510303
                },
                {
                        120.667582,
                        31.143294,
                        0.0,
                        0,
                        1598510308
                },
                {
                        120.667555,
                        31.143394,
                        0.0,
                        0,
                        1598510313
                },
                {
                        120.667570,
                        31.143567,
                        0.0,
                        0,
                        1598510318
                },
                {
                        120.667470,
                        31.143742,
                        0.0,
                        0,
                        1598510323
                },
                {
                        120.667506,
                        31.143737,
                        0.0,
                        0,
                        1598510328
                },
                {
                        120.667623,
                        31.143643,
                        0.0,
                        0,
                        1598510333
                },
                {
                        120.667538,
                        31.143541,
                        0.0,
                        0,
                        1598510338
                },
                {
                        120.667535,
                        31.143481,
                        0.0,
                        0,
                        1598510363
                },
                {
                        120.667528,
                        31.143656,
                        0.0,
                        0,
                        1598510368
                },
                {
                        120.667380,
                        31.143797,
                        0.0,
                        0,
                        1598510373
                },
                {
                        120.667309,
                        31.143805,
                        0.0,
                        0,
                        1598510378
                },
                {
                        120.667478,
                        31.143681,
                        0.0,
                        0,
                        1598510383
                },
                {
                        120.667516,
                        31.143651,
                        0.0,
                        0,
                        1598510388
                },
                {
                        120.667547,
                        31.143641,
                        0.0,
                        0,
                        1598510393
                },
                {
                        120.667518,
                        31.143619,
                        0.0,
                        0,
                        1598510398
                },
                {
                        120.667281,
                        31.143750,
                        0.0,
                        0,
                        1598510423
                },
                {
                        120.667645,
                        31.143494,
                        0.0,
                        0,
                        1598510428
                },
                {
                        120.667543,
                        31.143601,
                        0.0,
                        0,
                        1598510433
                },
                {
                        120.667498,
                        31.143621,
                        0.0,
                        0,
                        1598510438
                },
                {
                        120.667515,
                        31.143566,
                        0.0,
                        0,
                        1598510443
                },
                {
                        120.667575,
                        31.143492,
                        0.0,
                        0,
                        1598510448
                },
                {
                        120.667435,
                        31.143627,
                        0.0,
                        0,
                        1598510483
                },
                {
                        120.667191,
                        31.143617,
                        0.0,
                        0,
                        1598510488
                },
                {
                        120.667248,
                        31.143557,
                        0.0,
                        0,
                        1598510493
                },
                {
                        120.667346,
                        31.143542,
                        0.0,
                        0,
                        1598510498
                },
                {
                        120.667537,
                        31.143511,
                        0.0,
                        0,
                        1598510503
                },
                {
                        120.667485,
                        31.143504,
                        0.0,
                        0,
                        1598510508
                },
                {
                        120.667508,
                        31.143339,
                        0.0,
                        0,
                        1598510543
                },
                {
                        120.667490,
                        31.143387,
                        0.0,
                        0,
                        1598510548
                },
                {
                        120.667530,
                        31.143381,
                        0.0,
                        0,
                        1598510553
                },
                {
                        120.667637,
                        31.143529,
                        0.0,
                        0,
                        1598510558
                },
                {
                        120.667506,
                        31.143631,
                        0.0,
                        0,
                        1598510563
                },
                {
                        120.667334,
                        31.143655,
                        0.0,
                        0,
                        1598510568
                },
                {
                        120.667241,
                        31.143608,
                        0.0,
                        0,
                        1598510573
                },
                {
                        120.667226,
                        31.143598,
                        0.0,
                        0,
                        1598510578
                },
                {
                        120.667214,
                        31.143545,
                        0.0,
                        0,
                        1598510603
                },
                {
                        120.666899,
                        31.143730,
                        0.0,
                        0,
                        1598510608
                },
                {
                        120.666693,
                        31.143968,
                        0.0,
                        0,
                        1598510613
                },
                {
                        120.666666,
                        31.143951,
                        0.0,
                        0,
                        1598510618
                },
                {
                        120.666833,
                        31.143921,
                        0.0,
                        0,
                        1598510623
                },
                {
                        120.667015,
                        31.143883,
                        0.0,
                        0,
                        1598510628
                },
                {
                        120.667142,
                        31.143850,
                        0.0,
                        0,
                        1598510633
                },
                {
                        120.667122,
                        31.143802,
                        0.0,
                        0,
                        1598510663
                },
                {
                        120.667116,
                        31.143802,
                        0.0,
                        0,
                        1598510668
                },
                {
                        120.666945,
                        31.143906,
                        0.0,
                        0,
                        1598510673
                },
                {
                        120.666984,
                        31.143873,
                        0.0,
                        0,
                        1598510678
                },
                {
                        120.666992,
                        31.143851,
                        0.0,
                        0,
                        1598510683
                },
                {
                        120.667036,
                        31.143842,
                        0.0,
                        0,
                        1598510688
                },
                {
                        120.667157,
                        31.143833,
                        0.0,
                        0,
                        1598510693
                },
                {
                        120.667378,
                        31.143781,
                        0.0,
                        0,
                        1598510723
                },
                {
                        120.667565,
                        31.143804,
                        0.0,
                        0,
                        1598510728
                },
                {
                        120.667540,
                        31.143797,
                        0.0,
                        0,
                        1598510733
                },
                {
                        120.667515,
                        31.143837,
                        0.0,
                        0,
                        1598510738
                },
                {
                        120.667530,
                        31.143896,
                        0.0,
                        0,
                        1598510743
                },
                {
                        120.667515,
                        31.143949,
                        0.0,
                        0,
                        1598510748
                },
                {
                        120.667495,
                        31.143978,
                        0.0,
                        0,
                        1598510753
                },
                {
                        120.667453,
                        31.143977,
                        0.0,
                        0,
                        1598510758
                },
                {
                        120.667461,
                        31.144021,
                        0.0,
                        0,
                        1598510783
                },
                {
                        120.667493,
                        31.143989,
                        0.0,
                        0,
                        1598510788
                },
                {
                        120.667473,
                        31.144012,
                        0.0,
                        0,
                        1598510793
                },
                {
                        120.667471,
                        31.144032,
                        0.0,
                        0,
                        1598510798
                },
                {
                        120.667496,
                        31.144073,
                        0.0,
                        0,
                        1598510803
                },
                {
                        120.667471,
                        31.144083,
                        0.0,
                        0,
                        1598510808
                },
                {
                        120.667498,
                        31.144081,
                        0.0,
                        0,
                        1598510813
                },
                {
                        120.667456,
                        31.144101,
                        0.0,
                        0,
                        1598510818
                },
                {
                        120.667455,
                        31.144124,
                        0.0,
                        0,
                        1598510843
                },
                {
                        120.667460,
                        31.144116,
                        0.0,
                        0,
                        1598510848
                },
                {
                        120.667443,
                        31.144119,
                        0.0,
                        0,
                        1598510853
                },
                {
                        120.667433,
                        31.144127,
                        0.0,
                        0,
                        1598510858
                },
                {
                        120.667458,
                        31.144114,
                        0.0,
                        0,
                        1598510863
                },
                {
                        120.667453,
                        31.144121,
                        0.0,
                        0,
                        1598510868
                },
                {
                        120.667466,
                        31.144108,
                        0.0,
                        0,
                        1598510873
                },
                {
                        120.667458,
                        31.144111,
                        0.0,
                        0,
                        1598510878
                },
                {
                        120.667418,
                        31.144149,
                        0.0,
                        0,
                        1598510903
                },
                {
                        120.667471,
                        31.144211,
                        0.0,
                        0,
                        1598510908
                },
                {
                        120.667485,
                        31.144229,
                        0.0,
                        0,
                        1598510913
                },
                {
                        120.667496,
                        31.144276,
                        0.0,
                        0,
                        1598510918
                },
                {
                        120.667550,
                        31.144274,
                        0.0,
                        0,
                        1598510923
                },
                {
                        120.667557,
                        31.144273,
                        0.0,
                        0,
                        1598510928
                },
                {
                        120.667593,
                        31.144268,
                        0.0,
                        0,
                        1598510933
                },
                {
                        120.667647,
                        31.144250,
                        0.0,
                        0,
                        1598510938
                },
                {
                        120.667675,
                        31.144241,
                        0.0,
                        0,
                        1598510963
                },
                {
                        120.667737,
                        31.144248,
                        0.0,
                        0,
                        1598510968
                },
                {
                        120.667775,
                        31.144240,
                        0.0,
                        0,
                        1598510973
                },
                {
                        120.667805,
                        31.144230,
                        0.0,
                        0,
                        1598510978
                },
                {
                        120.667867,
                        31.144230,
                        0.0,
                        0,
                        1598510983
                },
                {
                        120.667904,
                        31.144275,
                        0.0,
                        0,
                        1598510988
                },
                {
                        120.667969,
                        31.144279,
                        0.0,
                        0,
                        1598510993
                },
                {
                        120.667991,
                        31.144272,
                        0.0,
                        0,
                        1598510998
                },
                {
                        120.668001,
                        31.144289,
                        0.0,
                        0,
                        1598511023
                },
                {
                        120.668053,
                        31.144294,
                        0.0,
                        0,
                        1598511028
                },
                {
                        120.668064,
                        31.144325,
                        0.0,
                        0,
                        1598511033
                },
                {
                        120.668068,
                        31.144339,
                        0.0,
                        0,
                        1598511038
                },
                {
                        120.668089,
                        31.144372,
                        0.0,
                        0,
                        1598511043
                },
                {
                        120.668099,
                        31.144407,
                        0.0,
                        0,
                        1598511048
                },
                {
                        120.668106,
                        31.144397,
                        0.0,
                        0,
                        1598511053
                },
                {
                        120.668084,
                        31.144385,
                        0.0,
                        0,
                        1598511058
                },
                {
                        120.668129,
                        31.144422,
                        0.0,
                        0,
                        1598511083
                },
                {
                        120.668158,
                        31.144507,
                        0.0,
                        0,
                        1598511088
                },
                {
                        120.668148,
                        31.144566,
                        0.0,
                        0,
                        1598511093
                },
                {
                        120.668155,
                        31.144599,
                        0.0,
                        0,
                        1598511098
                },
                {
                        120.668191,
                        31.144626,
                        0.0,
                        0,
                        1598511103
                },
                {
                        120.668268,
                        31.144648,
                        0.0,
                        0,
                        1598511108
                },
                {
                        120.668322,
                        31.144686,
                        0.0,
                        0,
                        1598511113
                },
                {
                        120.668393,
                        31.144718,
                        0.0,
                        0,
                        1598511118
                },
                {
                        120.668435,
                        31.144796,
                        0.0,
                        0,
                        1598511143
                },
                {
                        120.668507,
                        31.144793,
                        0.0,
                        0,
                        1598511148
                },
                {
                        120.668559,
                        31.144788,
                        0.0,
                        0,
                        1598511153
                },
                {
                        120.668612,
                        31.144782,
                        0.0,
                        0,
                        1598511158
                },
                {
                        120.668681,
                        31.144794,
                        0.0,
                        0,
                        1598511163
                },
                {
                        120.668697,
                        31.144812,
                        0.0,
                        0,
                        1598511168
                },
                {
                        120.668671,
                        31.144829,
                        0.0,
                        0,
                        1598511173
                },
                {
                        120.668657,
                        31.144833,
                        0.0,
                        0,
                        1598511178
                },
                {
                        120.668689,
                        31.144834,
                        0.0,
                        0,
                        1598511204
                },
                {
                        120.668739,
                        31.144795,
                        0.0,
                        0,
                        1598511209
                },
                {
                        120.668786,
                        31.144772,
                        0.0,
                        0,
                        1598511214
                },
                {
                        120.668884,
                        31.144789,
                        0.0,
                        0,
                        1598511219
                },
                {
                        120.668943,
                        31.144767,
                        0.0,
                        0,
                        1598511224
                },
                {
                        120.668961,
                        31.144772,
                        0.0,
                        0,
                        1598511229
                },
                {
                        120.669008,
                        31.144776,
                        0.0,
                        0,
                        1598511234
                },
                {
                        120.669045,
                        31.144766,
                        0.0,
                        0,
                        1598511239
                },
                {
                        120.669075,
                        31.144759,
                        0.0,
                        0,
                        1598511264
                },
                {
                        120.669071,
                        31.144801,
                        0.0,
                        0,
                        1598511269
                },
                {
                        120.669061,
                        31.144814,
                        0.0,
                        0,
                        1598511274
                },
                {
                        120.669055,
                        31.144801,
                        0.0,
                        0,
                        1598511279
                },
                {
                        120.669071,
                        31.144818,
                        0.0,
                        0,
                        1598511284
                },
                {
                        120.669075,
                        31.144816,
                        0.0,
                        0,
                        1598511289
                },
                {
                        120.669085,
                        31.144768,
                        0.0,
                        0,
                        1598511294
                },
                {
                        120.669086,
                        31.144763,
                        0.0,
                        0,
                        1598511299
                },
                {
                        120.669137,
                        31.144794,
                        0.0,
                        0,
                        1598511324
                },
                {
                        120.669232,
                        31.144798,
                        0.0,
                        0,
                        1598511329
                },
                {
                        120.669258,
                        31.144805,
                        0.0,
                        0,
                        1598511334
                },
                {
                        120.669289,
                        31.144790,
                        0.0,
                        0,
                        1598511339
                },
                {
                        120.669267,
                        31.144770,
                        0.0,
                        0,
                        1598511344
                },
                {
                        120.669278,
                        31.144768,
                        0.0,
                        0,
                        1598511349
                },
                {
                        120.669315,
                        31.144783,
                        0.0,
                        0,
                        1598511354
                },
                {
                        120.669384,
                        31.144778,
                        0.0,
                        0,
                        1598511359
                },
                {
                        120.669369,
                        31.144761,
                        0.0,
                        0,
                        1598511384
                },
                {
                        120.669364,
                        31.144756,
                        0.0,
                        0,
                        1598511389
                },
                {
                        120.669392,
                        31.144765,
                        0.0,
                        0,
                        1598511394
                },
                {
                        120.669392,
                        31.144748,
                        0.0,
                        0,
                        1598511399
                },
                {
                        120.669394,
                        31.144750,
                        0.0,
                        0,
                        1598511404
                },
                {
                        120.669410,
                        31.144732,
                        0.0,
                        0,
                        1598511409
                },
                {
                        120.669497,
                        31.144722,
                        0.0,
                        0,
                        1598511414
                },
                {
                        120.669517,
                        31.144710,
                        0.0,
                        0,
                        1598511419
                },
                {
                        120.669467,
                        31.144723,
                        0.0,
                        0,
                        1598511444
                },
                {
                        120.669454,
                        31.144745,
                        0.0,
                        0,
                        1598511449
                },
                {
                        120.669459,
                        31.144757,
                        0.0,
                        0,
                        1598511454
                },
                {
                        120.669506,
                        31.144770,
                        0.0,
                        0,
                        1598511459
                },
                {
                        120.669516,
                        31.144755,
                        0.0,
                        0,
                        1598511464
                },
                {
                        120.669502,
                        31.144743,
                        0.0,
                        0,
                        1598511469
                },
                {
                        120.669492,
                        31.144723,
                        0.0,
                        0,
                        1598511474
                },
                {
                        120.669502,
                        31.144723,
                        0.0,
                        0,
                        1598511479
                },
                {
                        120.669501,
                        31.144753,
                        0.0,
                        0,
                        1598511504
                },
                {
                        120.669506,
                        31.144773,
                        0.0,
                        0,
                        1598511509
                },
                {
                        120.669509,
                        31.144742,
                        0.0,
                        0,
                        1598511514
                },
                {
                        120.669178,
                        31.143821,
                        0.0,
                        0,
                        1598511519
                },
                {
                        120.668443,
                        31.139098,
                        0.0,
                        0,
                        1598511524
                },
                {
                        120.669308,
                        31.142539,
                        0.0,
                        0,
                        1598511529
                },
                {
                        120.669415,
                        31.144038,
                        0.0,
                        0,
                        1598511534
                },
                {
                        120.669571,
                        31.144368,
                        0.0,
                        0,
                        1598511539
                },
                {
                        120.669567,
                        31.144575,
                        0.0,
                        0,
                        1598511564
                },
                {
                        120.669511,
                        31.144610,
                        0.0,
                        0,
                        1598511569
                },
                {
                        120.669678,
                        31.144560,
                        0.0,
                        0,
                        1598511574
                },
                {
                        120.669753,
                        31.144412,
                        0.0,
                        0,
                        1598511579
                },
                {
                        120.669243,
                        31.144353,
                        0.0,
                        0,
                        1598511584
                },
                {
                        120.669140,
                        31.144346,
                        0.0,
                        0,
                        1598511589
                },
                {
                        120.669547,
                        31.144675,
                        0.0,
                        0,
                        1598511594
                },
                {
                        120.669584,
                        31.144730,
                        0.0,
                        0,
                        1598511599
                },
                {
                        120.669524,
                        31.144730,
                        0.0,
                        0,
                        1598511624
                },
                {
                        120.669472,
                        31.144722,
                        0.0,
                        0,
                        1598511629
                },
                {
                        120.669397,
                        31.144748,
                        0.0,
                        0,
                        1598511634
                },
                {
                        120.669395,
                        31.144755,
                        0.0,
                        0,
                        1598511639
                },
                {
                        120.669380,
                        31.144770,
                        0.0,
                        0,
                        1598511644
                },
                {
                        120.669394,
                        31.144763,
                        0.0,
                        0,
                        1598511649
                },
                {
                        120.669399,
                        31.144753,
                        0.0,
                        0,
                        1598511654
                },
                {
                        120.669414,
                        31.144742,
                        0.0,
                        0,
                        1598511659
                },
                {
                        120.669410,
                        31.144708,
                        0.0,
                        0,
                        1598511684
                },
                {
                        120.669374,
                        31.144711,
                        0.0,
                        0,
                        1598511689
                },
                {
                        120.669364,
                        31.144696,
                        0.0,
                        0,
                        1598511694
                },
                {
                        120.669322,
                        31.144678,
                        0.0,
                        0,
                        1598511699
                },
                {
                        120.669317,
                        31.144728,
                        0.0,
                        0,
                        1598511704
                },
                {
                        120.669300,
                        31.144755,
                        0.0,
                        0,
                        1598511709
                },
                {
                        120.669280,
                        31.144775,
                        0.0,
                        0,
                        1598511714
                },
                {
                        120.669252,
                        31.144796,
                        0.0,
                        0,
                        1598511719
                },
                {
                        120.669138,
                        31.144806,
                        0.0,
                        0,
                        1598511744
                },
                {
                        120.669046,
                        31.144808,
                        0.0,
                        0,
                        1598511749
                },
                {
                        120.668951,
                        31.144844,
                        0.0,
                        0,
                        1598511754
                },
                {
                        120.668904,
                        31.144886,
                        0.0,
                        0,
                        1598511759
                },
                {
                        120.668846,
                        31.144896,
                        0.0,
                        0,
                        1598511764
                },
                {
                        120.668799,
                        31.144894,
                        0.0,
                        0,
                        1598511769
                },
                {
                        120.668761,
                        31.144945,
                        0.0,
                        0,
                        1598511774
                },
                {
                        120.668724,
                        31.144945,
                        0.0,
                        0,
                        1598511779
                },
                {
                        120.668605,
                        31.144948,
                        0.0,
                        0,
                        1598511804
                },
                {
                        120.668539,
                        31.144953,
                        0.0,
                        0,
                        1598511809
                },
                {
                        120.668373,
                        31.144876,
                        0.0,
                        0,
                        1598511814
                },
                {
                        120.668181,
                        31.144908,
                        0.0,
                        0,
                        1598511819
                },
                {
                        120.668145,
                        31.144936,
                        0.0,
                        0,
                        1598511824
                },
                {
                        120.668099,
                        31.144962,
                        0.0,
                        0,
                        1598511829
                },
                {
                        120.668118,
                        31.144951,
                        0.0,
                        0,
                        1598511834
                },
                {
                        120.668114,
                        31.144939,
                        0.0,
                        0,
                        1598511839
                },
                {
                        120.668165,
                        31.144769,
                        0.0,
                        0,
                        1598511864
                },
                {
                        120.668170,
                        31.144692,
                        0.0,
                        0,
                        1598511869
                },
                {
                        120.668165,
                        31.144667,
                        0.0,
                        0,
                        1598511874
                },
                {
                        120.668171,
                        31.144597,
                        0.0,
                        0,
                        1598511879
                },
                {
                        120.668158,
                        31.144584,
                        0.0,
                        0,
                        1598511884
                },
                {
                        120.668155,
                        31.144569,
                        0.0,
                        0,
                        1598511889
                },
                {
                        120.668133,
                        31.144576,
                        0.0,
                        0,
                        1598511894
                },
                {
                        120.668123,
                        31.144542,
                        0.0,
                        0,
                        1598511899
                },
                {
                        120.668161,
                        31.144507,
                        0.0,
                        0,
                        1598511924
                },
                {
                        120.668200,
                        31.144499,
                        0.0,
                        0,
                        1598511929
                },
                {
                        120.668228,
                        31.144451,
                        0.0,
                        0,
                        1598511934
                },
                {
                        120.668221,
                        31.144451,
                        0.0,
                        0,
                        1598511939
                },
                {
                        120.668205,
                        31.144496,
                        0.0,
                        0,
                        1598511944
                },
                {
                        120.668205,
                        31.144532,
                        0.0,
                        0,
                        1598511949
                },
                {
                        120.668193,
                        31.144536,
                        0.0,
                        0,
                        1598511954
                },
                {
                        120.668201,
                        31.144541,
                        0.0,
                        0,
                        1598511959
                },
                {
                        120.668198,
                        31.144559,
                        0.0,
                        0,
                        1598511984
                },
                {
                        120.668210,
                        31.144562,
                        0.0,
                        0,
                        1598511989
                },
                {
                        120.668235,
                        31.144551,
                        0.0,
                        0,
                        1598511994
                },
                {
                        120.668230,
                        31.144551,
                        0.0,
                        0,
                        1598511999
                },
                {
                        120.668231,
                        31.144521,
                        0.0,
                        0,
                        1598512004
                },
                {
                        120.668104,
                        31.144457,
                        0.0,
                        0,
                        1598512009
                },
                {
                        120.668066,
                        31.144461,
                        0.0,
                        0,
                        1598512014
                },
                {
                        120.668091,
                        31.144497,
                        0.0,
                        0,
                        1598512019
                },
                {
                        120.668141,
                        31.144556,
                        0.0,
                        0,
                        1598512044
                },
                {
                        120.668118,
                        31.144601,
                        0.0,
                        0,
                        1598512049
                },
                {
                        120.668128,
                        31.144676,
                        0.0,
                        0,
                        1598512054
                },
                {
                        120.668134,
                        31.144691,
                        0.0,
                        0,
                        1598512059
                },
                {
                        120.668139,
                        31.144686,
                        0.0,
                        0,
                        1598512064
                },
                {
                        120.668118,
                        31.144687,
                        0.0,
                        0,
                        1598512069
                },
                {
                        120.668094,
                        31.144691,
                        0.0,
                        0,
                        1598512074
                },
                {
                        120.668098,
                        31.144684,
                        0.0,
                        0,
                        1598512079
                },
                {
                        120.668109,
                        31.144671,
                        0.0,
                        0,
                        1598512104
                },
                {
                        120.668054,
                        31.144696,
                        0.0,
                        0,
                        1598512109
                },
                {
                        120.668088,
                        31.144702,
                        0.0,
                        0,
                        1598512114
                },
                {
                        120.668096,
                        31.144682,
                        0.0,
                        0,
                        1598512119
                },
                {
                        120.668116,
                        31.144644,
                        0.0,
                        0,
                        1598512124
                },
                {
                        120.668139,
                        31.144629,
                        0.0,
                        0,
                        1598512129
                },
                {
                        120.668136,
                        31.144589,
                        0.0,
                        0,
                        1598512134
                },
                {
                        120.668124,
                        31.144517,
                        0.0,
                        0,
                        1598512139
                },
                {
                        120.668104,
                        31.144462,
                        0.0,
                        0,
                        1598512164
                },
                {
                        120.668048,
                        31.144432,
                        0.0,
                        0,
                        1598512169
                },
                {
                        120.667993,
                        31.144435,
                        0.0,
                        0,
                        1598512174
                },
                {
                        120.667956,
                        31.144435,
                        0.0,
                        0,
                        1598512179
                },
                {
                        120.667884,
                        31.144425,
                        0.0,
                        0,
                        1598512184
                },
                {
                        120.667861,
                        31.144447,
                        0.0,
                        0,
                        1598512189
                },
                {
                        120.667826,
                        31.144435,
                        0.0,
                        0,
                        1598512194
                },
                {
                        120.667774,
                        31.144425,
                        0.0,
                        0,
                        1598512199
                },
                {
                        120.667648,
                        31.144425,
                        0.0,
                        0,
                        1598512224
                },
                {
                        120.667570,
                        31.144376,
                        0.0,
                        0,
                        1598512229
                },
                {
                        120.666927,
                        31.144588,
                        0.0,
                        0,
                        1598512234
                },
                {
                        120.666793,
                        31.144640,
                        0.0,
                        0,
                        1598512239
                },
                {
                        120.666949,
                        31.144520,
                        0.0,
                        0,
                        1598512244
                },
                {
                        120.667104,
                        31.144422,
                        0.0,
                        0,
                        1598512249
                },
                {
                        120.667231,
                        31.144339,
                        0.0,
                        0,
                        1598512254
                },
                {
                        120.667296,
                        31.144307,
                        0.0,
                        0,
                        1598512259
                },
                {
                        120.667395,
                        31.144157,
                        0.0,
                        0,
                        1598512284
                },
                {
                        120.667403,
                        31.144079,
                        0.0,
                        0,
                        1598512289
                },
                {
                        120.667405,
                        31.144041,
                        0.0,
                        0,
                        1598512294
                },
                {
                        120.667430,
                        31.144029,
                        0.0,
                        0,
                        1598512299
                },
                {
                        120.667466,
                        31.144004,
                        0.0,
                        0,
                        1598512304
                },
                {
                        120.667481,
                        31.144001,
                        0.0,
                        0,
                        1598512309
                },
                {
                        120.667488,
                        31.144016,
                        0.0,
                        0,
                        1598512314
                },
                {
                        120.667506,
                        31.144044,
                        0.0,
                        0,
                        1598512319
                },
                {
                        120.667557,
                        31.144048,
                        0.0,
                        0,
                        1598512344
                },
                {
                        120.667239,
                        31.143827,
                        0.0,
                        0,
                        1598512404
                },
                {
                        120.667318,
                        31.143794,
                        0.0,
                        0,
                        1598512409
                },
                {
                        120.667565,
                        31.144058,
                        0.0,
                        0,
                        1598512414
                },
                {
                        120.667353,
                        31.144052,
                        0.0,
                        0,
                        1598512419
                },
                {
                        120.667488,
                        31.144059,
                        0.0,
                        0,
                        1598512424
                },
                {
                        120.667283,
                        31.144316,
                        0.0,
                        0,
                        1598512464
                },
                {
                        120.667401,
                        31.143772,
                        0.0,
                        0,
                        1598512469
                },
                {
                        120.667490,
                        31.143899,
                        0.0,
                        0,
                        1598512474
                },
                {
                        120.667423,
                        31.143966,
                        0.0,
                        0,
                        1598512479
                },
                {
                        120.667363,
                        31.143889,
                        0.0,
                        0,
                        1598512484
                },
                {
                        120.667408,
                        31.143806,
                        0.0,
                        0,
                        1598512489
                },
                {
                        120.667406,
                        31.143767,
                        0.0,
                        0,
                        1598512524
                },
                {
                        120.667538,
                        31.143834,
                        0.0,
                        0,
                        1598512529
                },
                {
                        120.667899,
                        31.143927,
                        0.0,
                        0,
                        1598512534
                },
                {
                        120.668003,
                        31.144037,
                        0.0,
                        0,
                        1598512539
                },
                {
                        120.668004,
                        31.144042,
                        0.0,
                        0,
                        1598512544
                },
                {
                        120.668448,
                        31.144736,
                        0.0,
                        0,
                        1598512549
                },
                {
                        120.668046,
                        31.144559,
                        0.0,
                        0,
                        1598512584
                },
                {
                        120.667844,
                        31.144400,
                        0.0,
                        0,
                        1598512589
                },
                {
                        120.668460,
                        31.144219,
                        0.0,
                        0,
                        1598512594
                },
                {
                        120.667684,
                        31.143856,
                        0.0,
                        0,
                        1598512599
                },
                {
                        120.667587,
                        31.143754,
                        0.0,
                        0,
                        1598512604
                },
                {
                        120.667354,
                        31.143597,
                        0.0,
                        0,
                        1598512609
                },
                {
                        120.667288,
                        31.143494,
                        0.0,
                        0,
                        1598512644
                },
                {
                        120.667324,
                        31.143562,
                        0.0,
                        0,
                        1598512649
                },
                {
                        120.667266,
                        31.143702,
                        0.0,
                        0,
                        1598512654
                },
                {
                        120.667311,
                        31.143705,
                        0.0,
                        0,
                        1598512659
                },
                {
                        120.667313,
                        31.143684,
                        0.0,
                        0,
                        1598512664
                },
                {
                        120.667333,
                        31.143392,
                        0.0,
                        0,
                        1598512669
                },
                {
                        120.667361,
                        31.143549,
                        0.0,
                        0,
                        1598512674
                },
                {
                        120.667278,
                        31.143695,
                        0.0,
                        0,
                        1598512704
                },
                {
                        120.667274,
                        31.143690,
                        0.0,
                        0,
                        1598512709
                },
                {
                        120.666833,
                        31.143473,
                        0.0,
                        0,
                        1598512714
                },
                {
                        120.667009,
                        31.143491,
                        0.0,
                        0,
                        1598512719
                },
                {
                        120.667049,
                        31.143525,
                        0.0,
                        0,
                        1598512724
                },
                {
                        120.667099,
                        31.143697,
                        0.0,
                        0,
                        1598512729
                },
                {
                        120.667261,
                        31.143675,
                        0.0,
                        0,
                        1598512734
                },
                {
                        120.667380,
                        31.143405,
                        0.0,
                        0,
                        1598512764
                },
                {
                        120.667800,
                        31.143738,
                        0.0,
                        0,
                        1598512769
                },
                {
                        120.667528,
                        31.143779,
                        0.0,
                        0,
                        1598512774
                },
                {
                        120.667522,
                        31.143809,
                        0.0,
                        0,
                        1598512779
                },
                {
                        120.667595,
                        31.143849,
                        0.0,
                        0,
                        1598512784
                },
                {
                        120.667500,
                        31.143889,
                        0.0,
                        0,
                        1598512789
                },
                {
                        120.667366,
                        31.143889,
                        0.0,
                        0,
                        1598512824
                },
                {
                        120.667199,
                        31.143927,
                        0.0,
                        0,
                        1598512829
                },
                {
                        120.667171,
                        31.144044,
                        0.0,
                        0,
                        1598512834
                },
                {
                        120.667203,
                        31.143935,
                        0.0,
                        0,
                        1598512839
                },
                {
                        120.667278,
                        31.143799,
                        0.0,
                        0,
                        1598512844
                },
                {
                        120.667460,
                        31.143751,
                        0.0,
                        0,
                        1598512849
                },
                {
                        120.667580,
                        31.143684,
                        0.0,
                        0,
                        1598512884
                },
                {
                        120.667532,
                        31.143824,
                        0.0,
                        0,
                        1598512889
                },
                {
                        120.667794,
                        31.144073,
                        0.0,
                        0,
                        1598512944
                },
                {
                        120.667851,
                        31.144218,
                        0.0,
                        0,
                        1598512949
                },
                {
                        120.667306,
                        31.143660,
                        0.0,
                        0,
                        1598512954
                },
                {
                        120.667530,
                        31.143664,
                        0.0,
                        0,
                        1598512959
                }
        };

        List<Points> pointsList = new ArrayList<>();
        for (Object[] doubles : objects) {
            Points traceLocation = new Points();
            traceLocation.setCoord_type_input("gcj02");
            traceLocation.setLongitude((Double) doubles[0]);
            traceLocation.setLatitude((Double) doubles[1]);
            traceLocation.setLoc_time(Long.parseLong(doubles[4].toString()));
            pointsList.add(traceLocation);
        }
        FilterPosition filterPosition = new FilterPosition();
        List<Points> PointsList = filterPosition.Pointss(pointsList);
        Double[][] geocodeArray = new Double[PointsList.size()][2];
        for (int i = 0; i < PointsList.size(); i++) {
            Points position = PointsList.get(i);
            geocodeArray[i][0] = position.getLongitude();
            geocodeArray[i][1] = position.getLatitude();
        }
        log.info(JSON.toJSONString(geocodeArray));
    }
}

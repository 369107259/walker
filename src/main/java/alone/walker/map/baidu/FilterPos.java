package alone.walker.map.baidu;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import lombok.extern.slf4j.Slf4j;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * @Author: huangYong
 * @Date: 2020/9/1 14:28
 */
@Slf4j
public class FilterPos {

    private final static String BMAP_AK = "46tHpSIHo8NOIYYf0N6WvGD0fcAp3BZ5";

    private final static String URL = "http://api.map.baidu.com/rectify/v1/track?";
    static Object[][] objects =
            {
                    {
                            120.549405,
                            31.289877,
                            0.0,
                            0,
                            1599612898
                    },
                    {
                            120.548670,
                            31.290548,
                            0.0,
                            0,
                            1599612963
                    },
                    {
                            120.549027,
                            31.290031,
                            0.0,
                            0,
                            1599612968
                    },
                    {
                            120.548049,
                            31.291043,
                            0.0,
                            0,
                            1599613008
                    },
                    {
                            120.548180,
                            31.291043,
                            0.0,
                            0,
                            1599613034
                    },
                    {
                            120.547622,
                            31.290187,
                            0.0,
                            0,
                            1599613038
                    },
                    {
                            120.548190,
                            31.289272,
                            0.0,
                            0,
                            1599613175
                    },
                    {
                            120.549373,
                            31.290230,
                            0.0,
                            0,
                            1599613369
                    },
                    {
                            120.549356,
                            31.290228,
                            0.0,
                            0,
                            1599613433
                    },
                    {
                            120.549356,
                            31.290047,
                            0.0,
                            0,
                            1599613451
                    },
                    {
                            120.549360,
                            31.289864,
                            0.0,
                            0,
                            1599613497
                    },
                    {
                            120.549434,
                            31.289856,
                            0.0,
                            0,
                            1599613656
                    },
                    {
                            120.549434,
                            31.289856,
                            0.0,
                            0,
                            1599613658
                    },
                    {
                            120.549372,
                            31.289873,
                            0.0,
                            0,
                            1599613667
                    },
                    {
                            120.549372,
                            31.289880,
                            0.0,
                            0,
                            1599613674
                    },
                    {
                            120.549372,
                            31.289873,
                            0.0,
                            0,
                            1599613702
                    },
                    {
                            120.549395,
                            31.289861,
                            0.0,
                            0,
                            1599613737
                    },
                    {
                            120.549404,
                            31.289884,
                            0.0,
                            0,
                            1599613756
                    },
                    {
                            120.547425,
                            31.288865,
                            0.0,
                            0,
                            1599613981
                    },
                    {
                            120.547574,
                            31.288993,
                            0.0,
                            0,
                            1599614041
                    },
                    {
                            120.547639,
                            31.289128,
                            0.0,
                            0,
                            1599614101
                    },
                    {
                            120.547633,
                            31.289156,
                            0.0,
                            0,
                            1599614106
                    },
                    {
                            120.547643,
                            31.289235,
                            0.0,
                            0,
                            1599614121
                    },
                    {
                            120.547635,
                            31.289275,
                            0.0,
                            0,
                            1599614131
                    },
                    {
                            120.547619,
                            31.289295,
                            0.0,
                            0,
                            1599614142
                    },
                    {
                            120.547609,
                            31.289295,
                            0.0,
                            0,
                            1599614146
                    },
                    {
                            120.547555,
                            31.289315,
                            0.0,
                            0,
                            1599614342
                    },
                    {
                            120.547615,
                            31.289338,
                            0.0,
                            0,
                            1599614402
                    },
                    {
                            120.547613,
                            31.289336,
                            0.0,
                            0,
                            1599614407
                    },
                    {
                            120.547602,
                            31.289328,
                            0.0,
                            0,
                            1599614417
                    },
                    {
                            120.547632,
                            31.289290,
                            0.0,
                            0,
                            1599614432
                    },
                    {
                            120.547632,
                            31.289280,
                            0.0,
                            0,
                            1599614437
                    },
                    {
                            120.547635,
                            31.289269,
                            0.0,
                            0,
                            1599614442
                    },
                    {
                            120.547862,
                            31.289303,
                            0.0,
                            0,
                            1599614642
                    },
                    {
                            120.547942,
                            31.289318,
                            0.0,
                            0,
                            1599614702
                    },
                    {
                            120.547942,
                            31.289318,
                            0.0,
                            0,
                            1599614707
                    },
                    {
                            120.549139,
                            31.288634,
                            0.0,
                            0,
                            1599614732
                    },
                    {
                            120.549139,
                            31.288634,
                            0.0,
                            0,
                            1599614737
                    },
                    {
                            120.549149,
                            31.288627,
                            0.0,
                            0,
                            1599614742
                    },
                    {
                            120.549136,
                            31.288639,
                            0.0,
                            0,
                            1599614762
                    },
                    {
                            120.548516,
                            31.291700,
                            0.0,
                            0,
                            1599614882
                    },
                    {
                            120.547856,
                            31.289327,
                            0.0,
                            0,
                            1599614942
                    },
                    {
                            120.549023,
                            31.289163,
                            0.0,
                            0,
                            1599615002
                    },
                    {
                            120.549023,
                            31.289256,
                            0.0,
                            0,
                            1599615007
                    },
                    {
                            120.548607,
                            31.289437,
                            0.0,
                            0,
                            1599615027
                    },
                    {
                            120.548607,
                            31.289437,
                            0.0,
                            0,
                            1599615032
                    },
                    {
                            120.548747,
                            31.290308,
                            0.0,
                            0,
                            1599615037
                    },
                    {
                            120.548747,
                            31.290308,
                            0.0,
                            0,
                            1599615042
                    },
                    {
                            120.548328,
                            31.290382,
                            0.0,
                            0,
                            1599615062
                    },
                    {
                            120.548074,
                            31.289388,
                            0.0,
                            0,
                            1599615123
                    },
                    {
                            120.547489,
                            31.289259,
                            0.0,
                            0,
                            1599615243
                    },
                    {
                            120.548860,
                            31.289550,
                            0.0,
                            0,
                            1599615303
                    },
                    {
                            120.548713,
                            31.289449,
                            0.0,
                            0,
                            1599615308
                    },
                    {
                            120.548713,
                            31.289449,
                            0.0,
                            0,
                            1599615313
                    },
                    {
                            120.548816,
                            31.289281,
                            0.0,
                            0,
                            1599615333
                    },
                    {
                            120.548932,
                            31.288979,
                            0.0,
                            0,
                            1599615338
                    },
                    {
                            120.548932,
                            31.288979,
                            0.0,
                            0,
                            1599615343
                    },
                    {
                            120.548873,
                            31.289843,
                            0.0,
                            0,
                            1599615543
                    },
                    {
                            120.548526,
                            31.288884,
                            0.0,
                            0,
                            1599615603
                    },
                    {
                            120.548697,
                            31.288749,
                            0.0,
                            0,
                            1599615608
                    },
                    {
                            120.548697,
                            31.288615,
                            0.0,
                            0,
                            1599615623
                    },
                    {
                            120.549077,
                            31.289073,
                            0.0,
                            0,
                            1599615638
                    },
                    {
                            120.549077,
                            31.289073,
                            0.0,
                            0,
                            1599615643
                    },
                    {
                            120.548270,
                            31.289261,
                            0.0,
                            0,
                            1599615723
                    },
                    {
                            120.549362,
                            31.289865,
                            0.0,
                            0,
                            1599615903
                    },
                    {
                            120.549356,
                            31.289865,
                            0.0,
                            0,
                            1599615908
                    },
                    {
                            120.549330,
                            31.289786,
                            0.0,
                            0,
                            1599615918
                    },
                    {
                            120.548836,
                            31.289701,
                            0.0,
                            0,
                            1599615928
                    },
                    {
                            120.548534,
                            31.289633,
                            0.0,
                            0,
                            1599615938
                    },
                    {
                            120.548430,
                            31.289611,
                            0.0,
                            0,
                            1599615943
                    },
                    {
                            120.548460,
                            31.289624,
                            0.0,
                            0,
                            1599615963
                    },
                    {
                            120.549251,
                            31.289867,
                            0.0,
                            0,
                            1599616204
                    },
                    {
                            120.547887,
                            31.289670,
                            0.0,
                            0,
                            1599616234
                    },
                    {
                            120.547215,
                            31.289473,
                            0.0,
                            0,
                            1599616239
                    },
                    {
                            120.547351,
                            31.289389,
                            0.0,
                            0,
                            1599616244
                    },
                    {
                            120.547512,
                            31.289205,
                            0.0,
                            0,
                            1599616444
                    },
                    {
                            120.548237,
                            31.289216,
                            0.0,
                            0,
                            1599616504
                    },
                    {
                            120.548303,
                            31.289244,
                            0.0,
                            0,
                            1599616509
                    },
                    {
                            120.547904,
                            31.289160,
                            0.0,
                            0,
                            1599616622
                    },
                    {
                            120.547904,
                            31.289175,
                            0.0,
                            0,
                            1599616682
                    },
                    {
                            120.547919,
                            31.289232,
                            0.0,
                            0,
                            1599616743
                    },
                    {
                            120.547866,
                            31.289234,
                            0.0,
                            0,
                            1599616748
                    },
                    {
                            120.547694,
                            31.289223,
                            0.0,
                            0,
                            1599616793
                    },
                    {
                            120.547719,
                            31.289218,
                            0.0,
                            0,
                            1599616798
                    },
                    {
                            120.547838,
                            31.289187,
                            0.0,
                            0,
                            1599616843
                    },
                    {
                            120.547816,
                            31.289177,
                            0.0,
                            0,
                            1599616858
                    },
                    {
                            120.547788,
                            31.289177,
                            0.0,
                            0,
                            1599616868
                    },
                    {
                            120.547731,
                            31.289164,
                            0.0,
                            0,
                            1599616883
                    },
                    {
                            120.547711,
                            31.289167,
                            0.0,
                            0,
                            1599616888
                    },
                    {
                            120.547703,
                            31.289171,
                            0.0,
                            0,
                            1599616893
                    },
                    {
                            120.547701,
                            31.289194,
                            0.0,
                            0,
                            1599616903
                    },
                    {
                            120.547700,
                            31.289207,
                            0.0,
                            0,
                            1599616908
                    },
                    {
                            120.547715,
                            31.289224,
                            0.0,
                            0,
                            1599616918
                    },
                    {
                            120.547732,
                            31.289235,
                            0.0,
                            0,
                            1599616938
                    },
                    {
                            120.547613,
                            31.289161,
                            0.0,
                            0,
                            1599616978
                    },
                    {
                            120.547606,
                            31.289147,
                            0.0,
                            0,
                            1599616983
                    },
                    {
                            120.547611,
                            31.289093,
                            0.0,
                            0,
                            1599617008
                    },
                    {
                            120.547608,
                            31.289088,
                            0.0,
                            0,
                            1599617013
                    },
                    {
                            120.547628,
                            31.289089,
                            0.0,
                            0,
                            1599617033
                    },
                    {
                            120.547644,
                            31.289113,
                            0.0,
                            0,
                            1599617043
                    },
                    {
                            120.547638,
                            31.289162,
                            0.0,
                            0,
                            1599617063
                    },
                    {
                            120.547572,
                            31.289158,
                            0.0,
                            0,
                            1599617083
                    },
                    {
                            120.547568,
                            31.289158,
                            0.0,
                            0,
                            1599617093
                    }
            };


    public static void main(String[] args) {
        List<Points> pointsList = new ArrayList<>();
        for (Object[] doubles : objects) {
            Points traceLocation = new Points();
            traceLocation.setCoord_type_input("gcj02");
            traceLocation.setLongitude((Double) doubles[0]);
            traceLocation.setLatitude((Double) doubles[1]);
            traceLocation.setLoc_time(Long.parseLong(doubles[4].toString()));
            pointsList.add(traceLocation);
        }
        System.out.println(JSON.toJSONString(pointsList));
        Map<String,String> param = new HashMap<>();
        param.put("ak",BMAP_AK);
        param.put("rectify_option","need_mapmatch:0|transport_mode:walking|denoise_grade:3|vacuate_grade:1");
        param.put("point_list",JSON.toJSONString(pointsList));
        param.put("supplement_mode","no_supplement");
        param.put("coord_type_output","gcj02");
        String doPost = HttpUtil.doPost(URL, param);
        JSONObject jsonObject = JSON.parseObject(doPost);
        if (Integer.parseInt(jsonObject.get("status").toString())== 0){
            JSONArray jsonArray = JSON.parseArray(JSON.toJSONString(jsonObject.get("points")));
            Double[][] geocodeArray = new Double[jsonArray.size()][2];
            for (int i = 0; i < jsonArray.size(); i++) {
                JSONObject jsonObject1 = JSON.parseObject(JSON.toJSONString(jsonArray.get(i)));
                geocodeArray[i][0] = Double.parseDouble(jsonObject1.get("longitude").toString()) ;
                geocodeArray[i][1] = Double.parseDouble(jsonObject1.get("latitude").toString()) ;
            }
            log.info(JSON.toJSONString(geocodeArray));
        }
    }

}
